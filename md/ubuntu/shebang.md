# shebang

### 2015-12-18 Fri

- shebang というものがある。スクリプトファイルの 1 行目にしばしば書かれるもののことである。特にそのうちの「#!」という文字列のことである。
- shebang という言葉は、語源が明らかでないらしい。ただし bang が ! を指すのは明らかである。hashbang と呼ばれることもあって、これは語源もなにもなく文字の名称なので、わかりやすい気がする。しかし、hashbang と言うと、URL における別の利用を指す場合があるようだ。
- Unix 系 OS においては、各プログラムの起動において汎用される、loader というプログラムがある。普通、loader に対しては、機械語のファイルが渡され、loader はそれを実行する。ただしもし、ファイルの先頭データが ASCII コードにおける（その OS の標準的な文字エンコーディングにおける） "#!" であった場合、1 行目を参考にプログラムを選択し、2 行目以降をそれに与える。例えば、あるインタープリタに、あるスクリプトファイルを与えることができる。
- 言い換えると、shebang を解釈しているのは text shell ではない。例えば bash で ./example.sh とした時、bash shell が行っているのは、このファイルを実行せよ、と OS に指示しているだけである。指示された OS が、ファイル先頭の 2 文字を読んで、判断する。
- インタープリタ、すなわちプログラムは、#!/bin/sh などとフルパスで指定される。そしてスクリプトのパスが例えば ~/example.sh だった場合、コマンドラインで /bin/sh ~/example.sh と実行したのと同じことになる。つまり、スクリプトファイルのフルパスが第 1 引数として渡される。
- 言い換えると、/bin/sh < ~/example.sh と実行したのと同じことになるわけではない。つまり、プログラム /bin/sh に渡されるデータは、標準入力によるのではなく、コマンドライン引数による。プログラムが、与えられたパスのファイルを開きたければ、開く。

    #!/bin/cat
    hello, world


